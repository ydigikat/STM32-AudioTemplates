# The Code
I do my work in C.  After 30+ years of embedded engineering, I kind of like it!  

I have chosen to use the STM low-level drivers as a thin layer on top of CMSIS, this just makes things a little more readable for people who are unfamiliar with the device.  There are minor calls where I've had to use register access because of lack of support in the LL drivers.

I don't like 'clever' code.  I've spent too many years unravelling clever code from the past where an engineer has long since departed.  There is rarely ever any need for it.

My coding style is what I like, you can reformat it or change it as you see fit.

The example oscillators are trivial and use floating point since the MCU has a hardware FPU.  I generally use floating point for my projects anyway, rarely do I need to revert to fixed point decimal these days.  You can of course use whatever you want.  

## The App
The app folder typically contains on a main.c file.

This file contains the ```main()``` function which provides an example of how to generate and send an output to I2S via DMA.  There are two test tone generators:

1. Sine approximation
2. Sawtooth (not antialiased)

The code can be used to check that the board and Audio DAC is working as expected.

## The BSP folder
This contains board support files.  These are specific to each of the boards and contain the initialisation functions for:

| File | Purpose | 
|------|---------|
| board.c/h| Clock tree, LED, BTN|
| audio.c/h| I2S, DMA |
| pins.h| The various pins/ports used by the audio hardware|

Anything else needed for the board will be in the board.c/h files, for example the STM32F411-Discovery has an onboard Audio DAC which requires I2C to configure. In this case I2C is setup in the BSP files.

Note: The BSP only supports the bare minimum needed to get audio running.  All other devices are left unconfigured.

## Drivers
These are the CMSIS and STM low-level driver files, these do not need to be touched.  I don't use the STM HAL. The LL drivers are a thin layer on top of the CMSIS that improve readability somewhat for people unfamiliar with the boards.

## Startup
Just the single startup assembly file that initialise the interrupt vectors.  Note that this also calls the ``init_board()`` function before ``main()``.

Generally you can use a .c file now for this and one day I'll get around to replacing this file.

[Back to README](../README.md)
